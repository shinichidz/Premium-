
repeat wait() until game:IsLoaded() and game.Players.LocalPlayer

local HttpService = game:GetService("HttpService")
local KeyCheckURL = "https://9e737e22-68e3-4ceb-8f2b-1b39eb08a1ab-00-394kcklzkji3d.pike.replit.dev/api/verify-key?key="

local function verifyKey(key)
    print("Đang kiểm tra key: " .. key)
    
    local success, response = pcall(function()
        return HttpService:GetAsync(KeyCheckURL .. key)
    end)

    if success then
        print("Phản hồi từ server: " .. response)
        local decodeSuccess, data = pcall(function()
            return HttpService:JSONDecode(response)
        end)

        if decodeSuccess then
            print("Dữ liệu đã giải mã: " .. HttpService:JSONEncode(data))
            return data.valid == true
        else
            print("Lỗi khi giải mã JSON: " .. response)
            return false
        end
    else
        print("Lỗi kết nối: " .. tostring(response))
        return false
    end
end

local key = getgenv().Key

if not key then
    warn("SHINICHIHUB: Chưa nhập key! Vui lòng đặt getgenv().Key trước khi chạy script.")
    return
end

local isValid = verifyKey(key)

if isValid then
    print("SHINICHIHUB: Xác thực key thành công!")
    loadstring(game:HttpGet("https://raw.githubusercontent.com/shinichidz/Premium-/refs/heads/main/ShinichiHubShiba"))()
else
    print("SHINICHIHUB: Key không hợp lệ!")
    
    -- Hiển thị lỗi UI
    local ScreenGui = Instance.new("ScreenGui")
    ScreenGui.Name = "ShinichiHubError"
    ScreenGui.Parent = game.CoreGui

    local Frame = Instance.new("Frame")
    Frame.Size = UDim2.new(0, 300, 0, 150)
    Frame.Position = UDim2.new(0.5, -150, 0.5, -75)
    Frame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
    Frame.BorderSizePixel = 0
    Frame.Parent = ScreenGui

    local Title = Instance.new("TextLabel")
    Title.Size = UDim2.new(1, 0, 0, 30)
    Title.Position = UDim2.new(0, 0, 0, 0)
    Title.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
    Title.BorderSizePixel = 0
    Title.Text = "SHINICHIHUB ERROR"
    Title.TextColor3 = Color3.fromRGB(255, 255, 255)
    Title.Font = Enum.Font.SourceSansBold
    Title.TextSize = 18
    Title.Parent = Frame

    local Message = Instance.new("TextLabel")
    Message.Size = UDim2.new(1, -20, 1, -60)
    Message.Position = UDim2.new(0, 10, 0, 40)
    Message.BackgroundTransparency = 1
    Message.Text = "Key không hợp lệ! Vui lòng kiểm tra lại key hoặc lấy key mới từ Discord SHINICHIHUB."
    Message.TextColor3 = Color3.fromRGB(255, 255, 255)
    Message.Font = Enum.Font.SourceSans
    Message.TextSize = 16
    Message.TextWrapped = true
    Message.Parent = Frame
    
    -- Kick người chơi sau một khoảng thời gian
    wait(5)
    game.Players.LocalPlayer:Kick("Key không hợp lệ! Vui lòng nhập đúng key từ Discord.")
end
