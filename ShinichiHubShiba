repeat wait() until game:IsLoaded() and game.Players.LocalPlayer

local HttpService = game:GetService("HttpService")
local KeyCheckURL = "https://9e737e22-68e3-4ceb-8f2b-1b39eb08a1ab-00-394kcklzkji3d.pike.replit.dev/api/verify-key?key="

local function isValidKey(key)
    print("Đang kiểm tra key: " .. key)
    print("URL: " .. KeyCheckURL .. key)

    local success, response = pcall(function()
        return HttpService:GetAsync(KeyCheckURL .. key)
    end)

    if success then
        print("Nhận được phản hồi từ server")
        local decodeSuccess, data = pcall(function()
            return HttpService:JSONDecode(response)
        end)

        if decodeSuccess then
            print("Dữ liệu phản hồi: " .. HttpService:JSONEncode(data))
            return data.valid == true
        else
            print("Lỗi decode JSON: " .. tostring(response))
            return false
        end
    else
        print("Lỗi kết nối: " .. tostring(response))
        return false
    end
end

-- Kiểm tra key
if not getgenv().Key then
    print("CẢNH BÁO: Key chưa được nhập!")
    game.Players.LocalPlayer:Kick("Vui lòng nhập key! Đọc hướng dẫn trên Discord.")
    return
end

local keyResult = isValidKey(getgenv().Key)
if keyResult then
    print("Key hợp lệ! Tải script...")
    loadstring(game:HttpGet("https://raw.githubusercontent.com/shinichidz/Premium-/refs/heads/main/ShinichiMainScript"))()
else
    print("Key không hợp lệ! Thoát game...")
    game.Players.LocalPlayer:Kick("Key không hợp lệ! Vui lòng nhập đúng key từ Discord.")
end
